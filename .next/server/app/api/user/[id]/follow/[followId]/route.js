"use strict";(()=>{var e={};e.id=839,e.ids=[839],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},74634:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>w,patchFetch:()=>y,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>c,staticGenerationAsyncStorage:()=>f});var r={};o.r(r),o.d(r,{POST:()=>d});var s=o(49303),l=o(88716),i=o(60670),a=o(9258),n=o(23650);let d=async(e,{params:t})=>{try{await (0,n.P)();let e=t.id,o=t.followId,r=await a.Z.findOne({clerkId:e}).populate("posts savedPosts likedPosts followers following"),s=await a.Z.findById(o).populate("posts savedPosts likedPosts followers following");return r?.following.find(e=>e._id.toString()===o)?(r.following=r.following.filter(e=>e._id.toString()!==o),s.followers=s.followers.filter(e=>e._id.toString()!==r._id.toString())):(r.following.push(s),s.followers.push(r)),await r.save(),await s.save(),new Response(JSON.stringify(r),{status:200})}catch(e){return console.log(e),new Response("Failed to follow/unfollow user",{status:500})}},p=new s.AppRouteRouteModule({definition:{kind:l.x.APP_ROUTE,page:"/api/user/[id]/follow/[followId]/route",pathname:"/api/user/[id]/follow/[followId]",filename:"route",bundlePath:"app/api/user/[id]/follow/[followId]/route"},resolvedPagePath:"C:\\Users\\Lappy\\OneDrive\\Desktop\\Sudhir-File\\nextjs-project\\my-app\\app\\api\\user\\[id]\\follow\\[followId]\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:u,staticGenerationAsyncStorage:f,serverHooks:c}=p,w="/api/user/[id]/follow/[followId]/route";function y(){return(0,i.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:f})}},9258:(e,t,o)=>{o.d(t,{Z:()=>i});var r=o(11185),s=o.n(r);let l=new(s()).Schema({clerkId:{type:String,required:!0,uinque:!0},firstName:{type:String,required:!0},lastName:{type:String,required:!0},username:{type:String,required:!0},email:{type:String,required:!0},profilePhoto:{type:String,required:!0},posts:{type:[{type:s().Schema.Types.ObjectId,ref:"Post"}],default:[]},savedPosts:{type:[{type:s().Schema.Types.ObjectId,ref:"Post"}],default:[]},likedPosts:{type:[{type:s().Schema.Types.ObjectId,ref:"Post"}],default:[]},followers:{type:[{type:s().Schema.Types.ObjectId,ref:"User"}],default:[]},following:{type:[{type:s().Schema.Types.ObjectId,ref:"User"}],default:[]},createdAt:{type:Date,default:Date.now}}),i=s().models.User||s().model("User",l)},23650:(e,t,o)=>{o.d(t,{P:()=>i});var r=o(11185),s=o.n(r);let l=!1,i=async()=>{if(s().set("strictQuery",!0),l){console.log("MongoDB is already connected");return}try{await s().connect(process.env.MONGODB_URL,{dbName:"my-app"}),l=!0,console.log("MongoDB is connected")}catch(e){console.log(e)}}},49303:(e,t,o)=>{e.exports=o(30517)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[948],()=>o(74634));module.exports=r})();