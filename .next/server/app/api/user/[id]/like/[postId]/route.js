"use strict";(()=>{var e={};e.id=866,e.ids=[866],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},90743:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>g,requestAsyncStorage:()=>c,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{POST:()=>l});var o=r(49303),i=r(88716),a=r(60670),p=r(54393),d=r(9258),n=r(23650);let l=async(e,{params:t})=>{try{await (0,n.P)();let e=t.id,r=t.postId,s=await d.Z.findOne({clerkId:e}).populate("posts savedPosts following followers").populate({path:"likedPosts",model:"Post",populate:{path:"creator",model:"User"}}),o=await p.Z.findById(r).populate("creator likes");return s.likedPosts.find(e=>e._id.toString()===r)?(s.likedPosts=s.likedPosts.filter(e=>e._id.toString()!==r),o.likes=o.likes.filter(e=>e._id.toString()!==s._id.toString())):(s.likedPosts.push(o._id),o.likes.push(s._id)),await s.save(),await o.save(),new Response(JSON.stringify(s),{status:200})}catch(e){return console.log(e),new Response("Failed to like/dislike post",{status:500})}},u=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/user/[id]/like/[postId]/route",pathname:"/api/user/[id]/like/[postId]",filename:"route",bundlePath:"app/api/user/[id]/like/[postId]/route"},resolvedPagePath:"C:\\Users\\Lappy\\OneDrive\\Desktop\\Sudhir-File\\nextjs-project\\my-app\\app\\api\\user\\[id]\\like\\[postId]\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:y,serverHooks:m}=u,f="/api/user/[id]/like/[postId]/route";function g(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:y})}},54393:(e,t,r)=>{r.d(t,{Z:()=>a});var s=r(11185),o=r.n(s);let i=new(o()).Schema({creator:{type:o().Schema.Types.ObjectId,ref:"User",required:!0},caption:{type:String,required:!0},postPhoto:{type:String,required:!0},tag:{type:String,required:!0},likes:{type:[{type:o().Schema.Types.ObjectId,ref:"User"}],default:[]},createdAt:{type:Date,default:Date.now}}),a=o().models.Post||o().model("Post",i)},9258:(e,t,r)=>{r.d(t,{Z:()=>a});var s=r(11185),o=r.n(s);let i=new(o()).Schema({clerkId:{type:String,required:!0,uinque:!0},firstName:{type:String,required:!0},lastName:{type:String,required:!0},username:{type:String,required:!0},email:{type:String,required:!0},profilePhoto:{type:String,required:!0},posts:{type:[{type:o().Schema.Types.ObjectId,ref:"Post"}],default:[]},savedPosts:{type:[{type:o().Schema.Types.ObjectId,ref:"Post"}],default:[]},likedPosts:{type:[{type:o().Schema.Types.ObjectId,ref:"Post"}],default:[]},followers:{type:[{type:o().Schema.Types.ObjectId,ref:"User"}],default:[]},following:{type:[{type:o().Schema.Types.ObjectId,ref:"User"}],default:[]},createdAt:{type:Date,default:Date.now}}),a=o().models.User||o().model("User",i)},23650:(e,t,r)=>{r.d(t,{P:()=>a});var s=r(11185),o=r.n(s);let i=!1,a=async()=>{if(o().set("strictQuery",!0),i){console.log("MongoDB is already connected");return}try{await o().connect(process.env.MONGODB_URL,{dbName:"my-app"}),i=!0,console.log("MongoDB is connected")}catch(e){console.log(e)}}},49303:(e,t,r)=>{e.exports=r(30517)}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948],()=>r(90743));module.exports=s})();