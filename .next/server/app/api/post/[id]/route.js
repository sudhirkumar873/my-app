"use strict";(()=>{var e={};e.id=110,e.ids=[110],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},73292:e=>{e.exports=require("fs/promises")},71017:e=>{e.exports=require("path")},71247:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>y,routeModule:()=>l,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g});var o={};r.r(o),r.d(o,{GET:()=>u,POST:()=>c});var a=r(49303),s=r(88716),i=r(60670),n=r(54393),p=r(23650),d=r(73292);let u=async(e,{params:t})=>{try{await (0,p.P)();let e=await n.Z.findById(t.id).populate("creator likes").exec();return new Response(JSON.stringify(e),{status:200})}catch(e){return console.error(e),new Response("Fail to get post by id",{status:500})}},c=async(e,{params:t})=>{let o=r(71017),a=process.cwd();try{await (0,p.P)();let r=await e.formData(),s=r.get("postPhoto");if("string"!=typeof s){let e=await s.arrayBuffer(),t=Buffer.from(e),r=o.join(a,"public","uploads",s.name);await (0,d.writeFile)(r,t),s=`/uploads/${s.name}`}let i=await n.Z.findByIdAndUpdate(t.id,{$set:{caption:r.get("caption"),tag:r.get("tag"),postPhoto:s}},{new:!0,useFindAndModify:!1});return await i.save(),new Response(JSON.stringify(i),{status:200})}catch(e){return console.error(e),new Response("Failed to update the post",{status:500})}},l=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/post/[id]/route",pathname:"/api/post/[id]",filename:"route",bundlePath:"app/api/post/[id]/route"},resolvedPagePath:"C:\\Users\\Lappy\\OneDrive\\Desktop\\Sudhir-File\\nextjs-project\\my-app\\app\\api\\post\\[id]\\route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:y,staticGenerationAsyncStorage:g,serverHooks:m}=l,f="/api/post/[id]/route";function h(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}},54393:(e,t,r)=>{r.d(t,{Z:()=>i});var o=r(11185),a=r.n(o);let s=new(a()).Schema({creator:{type:a().Schema.Types.ObjectId,ref:"User",required:!0},caption:{type:String,required:!0},postPhoto:{type:String,required:!0},tag:{type:String,required:!0},likes:{type:[{type:a().Schema.Types.ObjectId,ref:"User"}],default:[]},createdAt:{type:Date,default:Date.now}}),i=a().models.Post||a().model("Post",s)},23650:(e,t,r)=>{r.d(t,{P:()=>i});var o=r(11185),a=r.n(o);let s=!1,i=async()=>{if(a().set("strictQuery",!0),s){console.log("MongoDB is already connected");return}try{await a().connect(process.env.MONGODB_URL,{dbName:"my-app"}),s=!0,console.log("MongoDB is connected")}catch(e){console.log(e)}}},49303:(e,t,r)=>{e.exports=r(30517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[948],()=>r(71247));module.exports=o})();